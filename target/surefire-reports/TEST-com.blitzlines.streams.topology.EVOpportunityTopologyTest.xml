<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.772" tests="7" errors="0" skipped="0" failures="0">
  <properties>
    <property name="java.specification.version" value="17"/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/acheney/Public/blitz-lines-proj/kafka-streams-topology/target/test-classes:/home/acheney/Public/blitz-lines-proj/kafka-streams-topology/target/classes:/home/acheney/.m2/repository/org/apache/kafka/kafka-streams/3.6.1/kafka-streams-3.6.1.jar:/home/acheney/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.13.5/jackson-annotations-2.13.5.jar:/home/acheney/.m2/repository/org/apache/kafka/kafka-clients/3.6.1/kafka-clients-3.6.1.jar:/home/acheney/.m2/repository/com/github/luben/zstd-jni/1.5.5-1/zstd-jni-1.5.5-1.jar:/home/acheney/.m2/repository/org/lz4/lz4-java/1.8.0/lz4-java-1.8.0.jar:/home/acheney/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.16.1/jackson-databind-2.16.1.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.16.1/jackson-core-2.16.1.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.16.1/jackson-datatype-jsr310-2.16.1.jar:/home/acheney/.m2/repository/org/slf4j/slf4j-api/2.0.9/slf4j-api-2.0.9.jar:/home/acheney/.m2/repository/ch/qos/logback/logback-classic/1.4.14/logback-classic-1.4.14.jar:/home/acheney/.m2/repository/ch/qos/logback/logback-core/1.4.14/logback-core-1.4.14.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter/5.10.1/junit-jupiter-5.10.1.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.10.1/junit-jupiter-api-5.10.1.jar:/home/acheney/.m2/repository/org/opentest4j/opentest4j/1.3.0/opentest4j-1.3.0.jar:/home/acheney/.m2/repository/org/junit/platform/junit-platform-commons/1.10.1/junit-platform-commons-1.10.1.jar:/home/acheney/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.10.1/junit-jupiter-params-5.10.1.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.10.1/junit-jupiter-engine-5.10.1.jar:/home/acheney/.m2/repository/org/junit/platform/junit-platform-engine/1.10.1/junit-platform-engine-1.10.1.jar:/home/acheney/.m2/repository/org/apache/kafka/kafka-streams-test-utils/3.6.1/kafka-streams-test-utils-3.6.1.jar:"/>
    <property name="java.vm.vendor" value="Arch Linux"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://openjdk.java.net/"/>
    <property name="user.timezone" value="America/Los_Angeles"/>
    <property name="os.name" value="Linux"/>
    <property name="java.vm.specification.version" value="17"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="user.country" value="US"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-17-openjdk/lib"/>
    <property name="sun.java.command" value="/home/acheney/Public/blitz-lines-proj/kafka-streams-topology/target/surefire/surefirebooter-20251216222821603_3.jar /home/acheney/Public/blitz-lines-proj/kafka-streams-topology/target/surefire 2025-12-16T22-28-21_546-jvmRun1 surefire-20251216222821603_1tmp surefire_0-20251216222821603_2tmp"/>
    <property name="jdk.debug" value="release"/>
    <property name="surefire.test.class.path" value="/home/acheney/Public/blitz-lines-proj/kafka-streams-topology/target/test-classes:/home/acheney/Public/blitz-lines-proj/kafka-streams-topology/target/classes:/home/acheney/.m2/repository/org/apache/kafka/kafka-streams/3.6.1/kafka-streams-3.6.1.jar:/home/acheney/.m2/repository/org/rocksdb/rocksdbjni/7.9.2/rocksdbjni-7.9.2.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.13.5/jackson-annotations-2.13.5.jar:/home/acheney/.m2/repository/org/apache/kafka/kafka-clients/3.6.1/kafka-clients-3.6.1.jar:/home/acheney/.m2/repository/com/github/luben/zstd-jni/1.5.5-1/zstd-jni-1.5.5-1.jar:/home/acheney/.m2/repository/org/lz4/lz4-java/1.8.0/lz4-java-1.8.0.jar:/home/acheney/.m2/repository/org/xerial/snappy/snappy-java/1.1.10.5/snappy-java-1.1.10.5.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.16.1/jackson-databind-2.16.1.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.16.1/jackson-core-2.16.1.jar:/home/acheney/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.16.1/jackson-datatype-jsr310-2.16.1.jar:/home/acheney/.m2/repository/org/slf4j/slf4j-api/2.0.9/slf4j-api-2.0.9.jar:/home/acheney/.m2/repository/ch/qos/logback/logback-classic/1.4.14/logback-classic-1.4.14.jar:/home/acheney/.m2/repository/ch/qos/logback/logback-core/1.4.14/logback-core-1.4.14.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter/5.10.1/junit-jupiter-5.10.1.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.10.1/junit-jupiter-api-5.10.1.jar:/home/acheney/.m2/repository/org/opentest4j/opentest4j/1.3.0/opentest4j-1.3.0.jar:/home/acheney/.m2/repository/org/junit/platform/junit-platform-commons/1.10.1/junit-platform-commons-1.10.1.jar:/home/acheney/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.10.1/junit-jupiter-params-5.10.1.jar:/home/acheney/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.10.1/junit-jupiter-engine-5.10.1.jar:/home/acheney/.m2/repository/org/junit/platform/junit-platform-engine/1.10.1/junit-platform-engine-1.10.1.jar:/home/acheney/.m2/repository/org/apache/kafka/kafka-streams-test-utils/3.6.1/kafka-streams-test-utils-3.6.1.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/acheney"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.version.date" value="2025-10-21"/>
    <property name="java.home" value="/usr/lib/jvm/java-17-openjdk"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/acheney/Public/blitz-lines-proj/kafka-streams-topology"/>
    <property name="java.vm.compressedOopsMode" value="Zero based"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="surefire.real.class.path" value="/home/acheney/Public/blitz-lines-proj/kafka-streams-topology/target/surefire/surefirebooter-20251216222821603_3.jar"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="17.0.17+10"/>
    <property name="user.name" value="acheney"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="6.12.48-1-MANJARO"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="localRepository" value="/home/acheney/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://bugreport.java.com/bugreport/"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="17.0.17"/>
    <property name="user.dir" value="/home/acheney/Public/blitz-lines-proj/kafka-streams-topology"/>
    <property name="os.arch" value="amd64"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="native.encoding" value="UTF-8"/>
    <property name="java.library.path" value=":/usr/lib:/usr/lib:/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode, sharing"/>
    <property name="java.vendor" value="Arch Linux"/>
    <property name="java.vm.version" value="17.0.17+10"/>
    <property name="java.specification.maintenance.version" value="1"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="61.0"/>
  </properties>
  <testcase name="testMultipleSoftBooks" classname="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.322">
    <system-out><![CDATA[2025-12-16 22:28:22.126 [main] INFO  c.b.s.topology.EVOpportunityTopology - Building odds join topology...
2025-12-16 22:28:22.128 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: pinny-transformed with store: pinnacle-store
2025-12-16 22:28:22.137 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: kalshi-transformed with store: kalshi-store
2025-12-16 22:28:22.138 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: bovada-transformed with store: bovada-store
2025-12-16 22:28:22.138 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> kalshi
2025-12-16 22:28:22.143 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> bovada
2025-12-16 22:28:22.150 [main] INFO  c.b.s.topology.EVOpportunityTopology - Topology built successfully:
Topologies:
   Sub-topology: 0
    Source: KSTREAM-SOURCE-0000000000 (topics: [pinny-transformed])
      --> KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-KEY-SELECT-0000000001 (stores: [])
      --> KSTREAM-PEEK-0000000002
      <-- KSTREAM-SOURCE-0000000000
    Processor: KSTREAM-PEEK-0000000002 (stores: [])
      --> KSTREAM-FILTER-0000000005
      <-- KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-FILTER-0000000005 (stores: [])
      --> KSTREAM-SINK-0000000004
      <-- KSTREAM-PEEK-0000000002
    Sink: KSTREAM-SINK-0000000004 (topic: KSTREAM-TOTABLE-0000000003-repartition)
      <-- KSTREAM-FILTER-0000000005

  Sub-topology: 1
    Source: KSTREAM-SOURCE-0000000006 (topics: [KSTREAM-TOTABLE-0000000003-repartition])
      --> KSTREAM-TOTABLE-0000000003
    Processor: KSTREAM-TOTABLE-0000000003 (stores: [pinnacle-store])
      --> KTABLE-JOINTHIS-0000000023, KTABLE-JOINTHIS-0000000028
      <-- KSTREAM-SOURCE-0000000006
    Source: KSTREAM-SOURCE-0000000013 (topics: [KSTREAM-TOTABLE-0000000010-repartition])
      --> KSTREAM-TOTABLE-0000000010
    Source: KSTREAM-SOURCE-0000000020 (topics: [KSTREAM-TOTABLE-0000000017-repartition])
      --> KSTREAM-TOTABLE-0000000017
    Processor: KSTREAM-TOTABLE-0000000010 (stores: [kalshi-store])
      --> KTABLE-JOINOTHER-0000000024
      <-- KSTREAM-SOURCE-0000000013
    Processor: KSTREAM-TOTABLE-0000000017 (stores: [bovada-store])
      --> KTABLE-JOINOTHER-0000000029
      <-- KSTREAM-SOURCE-0000000020
    Processor: KTABLE-JOINOTHER-0000000024 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000010
    Processor: KTABLE-JOINOTHER-0000000029 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000017
    Processor: KTABLE-JOINTHIS-0000000023 (stores: [kalshi-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-JOINTHIS-0000000028 (stores: [bovada-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-MERGE-0000000022 (stores: [KTABLE-MERGE-STATE-STORE-0000000021])
      --> KTABLE-TOSTREAM-0000000025
      <-- KTABLE-JOINTHIS-0000000023, KTABLE-JOINOTHER-0000000024
    Processor: KTABLE-MERGE-0000000027 (stores: [KTABLE-MERGE-STATE-STORE-0000000026])
      --> KTABLE-TOSTREAM-0000000030
      <-- KTABLE-JOINTHIS-0000000028, KTABLE-JOINOTHER-0000000029
    Processor: KTABLE-TOSTREAM-0000000025 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000022
    Processor: KTABLE-TOSTREAM-0000000030 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000027
    Processor: KSTREAM-MERGE-0000000031 (stores: [])
      --> KSTREAM-FILTER-0000000032
      <-- KTABLE-TOSTREAM-0000000025, KTABLE-TOSTREAM-0000000030
    Processor: KSTREAM-FILTER-0000000032 (stores: [])
      --> KSTREAM-PEEK-0000000033
      <-- KSTREAM-MERGE-0000000031
    Processor: KSTREAM-PEEK-0000000033 (stores: [])
      --> KSTREAM-SINK-0000000034
      <-- KSTREAM-FILTER-0000000032
    Sink: KSTREAM-SINK-0000000034 (topic: joined-odds)
      <-- KSTREAM-PEEK-0000000033

  Sub-topology: 2
    Source: KSTREAM-SOURCE-0000000007 (topics: [kalshi-transformed])
      --> KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-KEY-SELECT-0000000008 (stores: [])
      --> KSTREAM-PEEK-0000000009
      <-- KSTREAM-SOURCE-0000000007
    Processor: KSTREAM-PEEK-0000000009 (stores: [])
      --> KSTREAM-FILTER-0000000012
      <-- KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-FILTER-0000000012 (stores: [])
      --> KSTREAM-SINK-0000000011
      <-- KSTREAM-PEEK-0000000009
    Sink: KSTREAM-SINK-0000000011 (topic: KSTREAM-TOTABLE-0000000010-repartition)
      <-- KSTREAM-FILTER-0000000012

  Sub-topology: 3
    Source: KSTREAM-SOURCE-0000000014 (topics: [bovada-transformed])
      --> KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-KEY-SELECT-0000000015 (stores: [])
      --> KSTREAM-PEEK-0000000016
      <-- KSTREAM-SOURCE-0000000014
    Processor: KSTREAM-PEEK-0000000016 (stores: [])
      --> KSTREAM-FILTER-0000000019
      <-- KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-FILTER-0000000019 (stores: [])
      --> KSTREAM-SINK-0000000018
      <-- KSTREAM-PEEK-0000000016
    Sink: KSTREAM-SINK-0000000018 (topic: KSTREAM-TOTABLE-0000000017-repartition)
      <-- KSTREAM-FILTER-0000000019


2025-12-16 22:28:22.193 [main] WARN  o.a.k.s.p.internals.StateDirectory - Using an OS temp directory in the state.dir property can cause failures with writing the checkpoint file due to the fact that this directory can be cleared by the OS. Resolved state.dir: [/tmp/kafka-streams]
2025-12-16 22:28:22.408 [main] INFO  c.b.s.topology.EVOpportunityTopology - Joined odds: Over 45.5 | pinnacle @ 1.95 vs kalshi @ 2.1
2025-12-16 22:28:22.414 [main] INFO  c.b.s.topology.EVOpportunityTopology - Joined odds: Over 45.5 | pinnacle @ 1.95 vs bovada @ 2.05
]]></system-out>
  </testcase>
  <testcase name="testNoJoinWithoutSharpBook" classname="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.049">
    <system-out><![CDATA[2025-12-16 22:28:22.434 [main] INFO  c.b.s.topology.EVOpportunityTopology - Building odds join topology...
2025-12-16 22:28:22.434 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: pinny-transformed with store: pinnacle-store
2025-12-16 22:28:22.435 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: kalshi-transformed with store: kalshi-store
2025-12-16 22:28:22.435 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: bovada-transformed with store: bovada-store
2025-12-16 22:28:22.435 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> kalshi
2025-12-16 22:28:22.435 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> bovada
2025-12-16 22:28:22.436 [main] INFO  c.b.s.topology.EVOpportunityTopology - Topology built successfully:
Topologies:
   Sub-topology: 0
    Source: KSTREAM-SOURCE-0000000000 (topics: [pinny-transformed])
      --> KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-KEY-SELECT-0000000001 (stores: [])
      --> KSTREAM-PEEK-0000000002
      <-- KSTREAM-SOURCE-0000000000
    Processor: KSTREAM-PEEK-0000000002 (stores: [])
      --> KSTREAM-FILTER-0000000005
      <-- KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-FILTER-0000000005 (stores: [])
      --> KSTREAM-SINK-0000000004
      <-- KSTREAM-PEEK-0000000002
    Sink: KSTREAM-SINK-0000000004 (topic: KSTREAM-TOTABLE-0000000003-repartition)
      <-- KSTREAM-FILTER-0000000005

  Sub-topology: 1
    Source: KSTREAM-SOURCE-0000000006 (topics: [KSTREAM-TOTABLE-0000000003-repartition])
      --> KSTREAM-TOTABLE-0000000003
    Processor: KSTREAM-TOTABLE-0000000003 (stores: [pinnacle-store])
      --> KTABLE-JOINTHIS-0000000023, KTABLE-JOINTHIS-0000000028
      <-- KSTREAM-SOURCE-0000000006
    Source: KSTREAM-SOURCE-0000000013 (topics: [KSTREAM-TOTABLE-0000000010-repartition])
      --> KSTREAM-TOTABLE-0000000010
    Source: KSTREAM-SOURCE-0000000020 (topics: [KSTREAM-TOTABLE-0000000017-repartition])
      --> KSTREAM-TOTABLE-0000000017
    Processor: KSTREAM-TOTABLE-0000000010 (stores: [kalshi-store])
      --> KTABLE-JOINOTHER-0000000024
      <-- KSTREAM-SOURCE-0000000013
    Processor: KSTREAM-TOTABLE-0000000017 (stores: [bovada-store])
      --> KTABLE-JOINOTHER-0000000029
      <-- KSTREAM-SOURCE-0000000020
    Processor: KTABLE-JOINOTHER-0000000024 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000010
    Processor: KTABLE-JOINOTHER-0000000029 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000017
    Processor: KTABLE-JOINTHIS-0000000023 (stores: [kalshi-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-JOINTHIS-0000000028 (stores: [bovada-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-MERGE-0000000022 (stores: [KTABLE-MERGE-STATE-STORE-0000000021])
      --> KTABLE-TOSTREAM-0000000025
      <-- KTABLE-JOINTHIS-0000000023, KTABLE-JOINOTHER-0000000024
    Processor: KTABLE-MERGE-0000000027 (stores: [KTABLE-MERGE-STATE-STORE-0000000026])
      --> KTABLE-TOSTREAM-0000000030
      <-- KTABLE-JOINTHIS-0000000028, KTABLE-JOINOTHER-0000000029
    Processor: KTABLE-TOSTREAM-0000000025 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000022
    Processor: KTABLE-TOSTREAM-0000000030 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000027
    Processor: KSTREAM-MERGE-0000000031 (stores: [])
      --> KSTREAM-FILTER-0000000032
      <-- KTABLE-TOSTREAM-0000000025, KTABLE-TOSTREAM-0000000030
    Processor: KSTREAM-FILTER-0000000032 (stores: [])
      --> KSTREAM-PEEK-0000000033
      <-- KSTREAM-MERGE-0000000031
    Processor: KSTREAM-PEEK-0000000033 (stores: [])
      --> KSTREAM-SINK-0000000034
      <-- KSTREAM-FILTER-0000000032
    Sink: KSTREAM-SINK-0000000034 (topic: joined-odds)
      <-- KSTREAM-PEEK-0000000033

  Sub-topology: 2
    Source: KSTREAM-SOURCE-0000000007 (topics: [kalshi-transformed])
      --> KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-KEY-SELECT-0000000008 (stores: [])
      --> KSTREAM-PEEK-0000000009
      <-- KSTREAM-SOURCE-0000000007
    Processor: KSTREAM-PEEK-0000000009 (stores: [])
      --> KSTREAM-FILTER-0000000012
      <-- KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-FILTER-0000000012 (stores: [])
      --> KSTREAM-SINK-0000000011
      <-- KSTREAM-PEEK-0000000009
    Sink: KSTREAM-SINK-0000000011 (topic: KSTREAM-TOTABLE-0000000010-repartition)
      <-- KSTREAM-FILTER-0000000012

  Sub-topology: 3
    Source: KSTREAM-SOURCE-0000000014 (topics: [bovada-transformed])
      --> KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-KEY-SELECT-0000000015 (stores: [])
      --> KSTREAM-PEEK-0000000016
      <-- KSTREAM-SOURCE-0000000014
    Processor: KSTREAM-PEEK-0000000016 (stores: [])
      --> KSTREAM-FILTER-0000000019
      <-- KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-FILTER-0000000019 (stores: [])
      --> KSTREAM-SINK-0000000018
      <-- KSTREAM-PEEK-0000000016
    Sink: KSTREAM-SINK-0000000018 (topic: KSTREAM-TOTABLE-0000000017-repartition)
      <-- KSTREAM-FILTER-0000000019


2025-12-16 22:28:22.437 [main] WARN  o.a.k.s.p.internals.StateDirectory - Using an OS temp directory in the state.dir property can cause failures with writing the checkpoint file due to the fact that this directory can be cleared by the OS. Resolved state.dir: [/tmp/kafka-streams]
]]></system-out>
  </testcase>
  <testcase name="testJoinKeyMatching_DifferentLineValues" classname="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.045">
    <system-out><![CDATA[2025-12-16 22:28:22.484 [main] INFO  c.b.s.topology.EVOpportunityTopology - Building odds join topology...
2025-12-16 22:28:22.485 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: pinny-transformed with store: pinnacle-store
2025-12-16 22:28:22.485 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: kalshi-transformed with store: kalshi-store
2025-12-16 22:28:22.485 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: bovada-transformed with store: bovada-store
2025-12-16 22:28:22.486 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> kalshi
2025-12-16 22:28:22.486 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> bovada
2025-12-16 22:28:22.487 [main] INFO  c.b.s.topology.EVOpportunityTopology - Topology built successfully:
Topologies:
   Sub-topology: 0
    Source: KSTREAM-SOURCE-0000000000 (topics: [pinny-transformed])
      --> KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-KEY-SELECT-0000000001 (stores: [])
      --> KSTREAM-PEEK-0000000002
      <-- KSTREAM-SOURCE-0000000000
    Processor: KSTREAM-PEEK-0000000002 (stores: [])
      --> KSTREAM-FILTER-0000000005
      <-- KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-FILTER-0000000005 (stores: [])
      --> KSTREAM-SINK-0000000004
      <-- KSTREAM-PEEK-0000000002
    Sink: KSTREAM-SINK-0000000004 (topic: KSTREAM-TOTABLE-0000000003-repartition)
      <-- KSTREAM-FILTER-0000000005

  Sub-topology: 1
    Source: KSTREAM-SOURCE-0000000006 (topics: [KSTREAM-TOTABLE-0000000003-repartition])
      --> KSTREAM-TOTABLE-0000000003
    Processor: KSTREAM-TOTABLE-0000000003 (stores: [pinnacle-store])
      --> KTABLE-JOINTHIS-0000000023, KTABLE-JOINTHIS-0000000028
      <-- KSTREAM-SOURCE-0000000006
    Source: KSTREAM-SOURCE-0000000013 (topics: [KSTREAM-TOTABLE-0000000010-repartition])
      --> KSTREAM-TOTABLE-0000000010
    Source: KSTREAM-SOURCE-0000000020 (topics: [KSTREAM-TOTABLE-0000000017-repartition])
      --> KSTREAM-TOTABLE-0000000017
    Processor: KSTREAM-TOTABLE-0000000010 (stores: [kalshi-store])
      --> KTABLE-JOINOTHER-0000000024
      <-- KSTREAM-SOURCE-0000000013
    Processor: KSTREAM-TOTABLE-0000000017 (stores: [bovada-store])
      --> KTABLE-JOINOTHER-0000000029
      <-- KSTREAM-SOURCE-0000000020
    Processor: KTABLE-JOINOTHER-0000000024 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000010
    Processor: KTABLE-JOINOTHER-0000000029 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000017
    Processor: KTABLE-JOINTHIS-0000000023 (stores: [kalshi-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-JOINTHIS-0000000028 (stores: [bovada-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-MERGE-0000000022 (stores: [KTABLE-MERGE-STATE-STORE-0000000021])
      --> KTABLE-TOSTREAM-0000000025
      <-- KTABLE-JOINTHIS-0000000023, KTABLE-JOINOTHER-0000000024
    Processor: KTABLE-MERGE-0000000027 (stores: [KTABLE-MERGE-STATE-STORE-0000000026])
      --> KTABLE-TOSTREAM-0000000030
      <-- KTABLE-JOINTHIS-0000000028, KTABLE-JOINOTHER-0000000029
    Processor: KTABLE-TOSTREAM-0000000025 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000022
    Processor: KTABLE-TOSTREAM-0000000030 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000027
    Processor: KSTREAM-MERGE-0000000031 (stores: [])
      --> KSTREAM-FILTER-0000000032
      <-- KTABLE-TOSTREAM-0000000025, KTABLE-TOSTREAM-0000000030
    Processor: KSTREAM-FILTER-0000000032 (stores: [])
      --> KSTREAM-PEEK-0000000033
      <-- KSTREAM-MERGE-0000000031
    Processor: KSTREAM-PEEK-0000000033 (stores: [])
      --> KSTREAM-SINK-0000000034
      <-- KSTREAM-FILTER-0000000032
    Sink: KSTREAM-SINK-0000000034 (topic: joined-odds)
      <-- KSTREAM-PEEK-0000000033

  Sub-topology: 2
    Source: KSTREAM-SOURCE-0000000007 (topics: [kalshi-transformed])
      --> KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-KEY-SELECT-0000000008 (stores: [])
      --> KSTREAM-PEEK-0000000009
      <-- KSTREAM-SOURCE-0000000007
    Processor: KSTREAM-PEEK-0000000009 (stores: [])
      --> KSTREAM-FILTER-0000000012
      <-- KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-FILTER-0000000012 (stores: [])
      --> KSTREAM-SINK-0000000011
      <-- KSTREAM-PEEK-0000000009
    Sink: KSTREAM-SINK-0000000011 (topic: KSTREAM-TOTABLE-0000000010-repartition)
      <-- KSTREAM-FILTER-0000000012

  Sub-topology: 3
    Source: KSTREAM-SOURCE-0000000014 (topics: [bovada-transformed])
      --> KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-KEY-SELECT-0000000015 (stores: [])
      --> KSTREAM-PEEK-0000000016
      <-- KSTREAM-SOURCE-0000000014
    Processor: KSTREAM-PEEK-0000000016 (stores: [])
      --> KSTREAM-FILTER-0000000019
      <-- KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-FILTER-0000000019 (stores: [])
      --> KSTREAM-SINK-0000000018
      <-- KSTREAM-PEEK-0000000016
    Sink: KSTREAM-SINK-0000000018 (topic: KSTREAM-TOTABLE-0000000017-repartition)
      <-- KSTREAM-FILTER-0000000019


2025-12-16 22:28:22.489 [main] WARN  o.a.k.s.p.internals.StateDirectory - Using an OS temp directory in the state.dir property can cause failures with writing the checkpoint file due to the fact that this directory can be cleared by the OS. Resolved state.dir: [/tmp/kafka-streams]
]]></system-out>
  </testcase>
  <testcase name="testOddsUpdateTriggersNewJoin" classname="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.052">
    <system-out><![CDATA[2025-12-16 22:28:22.530 [main] INFO  c.b.s.topology.EVOpportunityTopology - Building odds join topology...
2025-12-16 22:28:22.530 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: pinny-transformed with store: pinnacle-store
2025-12-16 22:28:22.530 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: kalshi-transformed with store: kalshi-store
2025-12-16 22:28:22.530 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: bovada-transformed with store: bovada-store
2025-12-16 22:28:22.531 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> kalshi
2025-12-16 22:28:22.531 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> bovada
2025-12-16 22:28:22.531 [main] INFO  c.b.s.topology.EVOpportunityTopology - Topology built successfully:
Topologies:
   Sub-topology: 0
    Source: KSTREAM-SOURCE-0000000000 (topics: [pinny-transformed])
      --> KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-KEY-SELECT-0000000001 (stores: [])
      --> KSTREAM-PEEK-0000000002
      <-- KSTREAM-SOURCE-0000000000
    Processor: KSTREAM-PEEK-0000000002 (stores: [])
      --> KSTREAM-FILTER-0000000005
      <-- KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-FILTER-0000000005 (stores: [])
      --> KSTREAM-SINK-0000000004
      <-- KSTREAM-PEEK-0000000002
    Sink: KSTREAM-SINK-0000000004 (topic: KSTREAM-TOTABLE-0000000003-repartition)
      <-- KSTREAM-FILTER-0000000005

  Sub-topology: 1
    Source: KSTREAM-SOURCE-0000000006 (topics: [KSTREAM-TOTABLE-0000000003-repartition])
      --> KSTREAM-TOTABLE-0000000003
    Processor: KSTREAM-TOTABLE-0000000003 (stores: [pinnacle-store])
      --> KTABLE-JOINTHIS-0000000023, KTABLE-JOINTHIS-0000000028
      <-- KSTREAM-SOURCE-0000000006
    Source: KSTREAM-SOURCE-0000000013 (topics: [KSTREAM-TOTABLE-0000000010-repartition])
      --> KSTREAM-TOTABLE-0000000010
    Source: KSTREAM-SOURCE-0000000020 (topics: [KSTREAM-TOTABLE-0000000017-repartition])
      --> KSTREAM-TOTABLE-0000000017
    Processor: KSTREAM-TOTABLE-0000000010 (stores: [kalshi-store])
      --> KTABLE-JOINOTHER-0000000024
      <-- KSTREAM-SOURCE-0000000013
    Processor: KSTREAM-TOTABLE-0000000017 (stores: [bovada-store])
      --> KTABLE-JOINOTHER-0000000029
      <-- KSTREAM-SOURCE-0000000020
    Processor: KTABLE-JOINOTHER-0000000024 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000010
    Processor: KTABLE-JOINOTHER-0000000029 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000017
    Processor: KTABLE-JOINTHIS-0000000023 (stores: [kalshi-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-JOINTHIS-0000000028 (stores: [bovada-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-MERGE-0000000022 (stores: [KTABLE-MERGE-STATE-STORE-0000000021])
      --> KTABLE-TOSTREAM-0000000025
      <-- KTABLE-JOINTHIS-0000000023, KTABLE-JOINOTHER-0000000024
    Processor: KTABLE-MERGE-0000000027 (stores: [KTABLE-MERGE-STATE-STORE-0000000026])
      --> KTABLE-TOSTREAM-0000000030
      <-- KTABLE-JOINTHIS-0000000028, KTABLE-JOINOTHER-0000000029
    Processor: KTABLE-TOSTREAM-0000000025 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000022
    Processor: KTABLE-TOSTREAM-0000000030 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000027
    Processor: KSTREAM-MERGE-0000000031 (stores: [])
      --> KSTREAM-FILTER-0000000032
      <-- KTABLE-TOSTREAM-0000000025, KTABLE-TOSTREAM-0000000030
    Processor: KSTREAM-FILTER-0000000032 (stores: [])
      --> KSTREAM-PEEK-0000000033
      <-- KSTREAM-MERGE-0000000031
    Processor: KSTREAM-PEEK-0000000033 (stores: [])
      --> KSTREAM-SINK-0000000034
      <-- KSTREAM-FILTER-0000000032
    Sink: KSTREAM-SINK-0000000034 (topic: joined-odds)
      <-- KSTREAM-PEEK-0000000033

  Sub-topology: 2
    Source: KSTREAM-SOURCE-0000000007 (topics: [kalshi-transformed])
      --> KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-KEY-SELECT-0000000008 (stores: [])
      --> KSTREAM-PEEK-0000000009
      <-- KSTREAM-SOURCE-0000000007
    Processor: KSTREAM-PEEK-0000000009 (stores: [])
      --> KSTREAM-FILTER-0000000012
      <-- KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-FILTER-0000000012 (stores: [])
      --> KSTREAM-SINK-0000000011
      <-- KSTREAM-PEEK-0000000009
    Sink: KSTREAM-SINK-0000000011 (topic: KSTREAM-TOTABLE-0000000010-repartition)
      <-- KSTREAM-FILTER-0000000012

  Sub-topology: 3
    Source: KSTREAM-SOURCE-0000000014 (topics: [bovada-transformed])
      --> KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-KEY-SELECT-0000000015 (stores: [])
      --> KSTREAM-PEEK-0000000016
      <-- KSTREAM-SOURCE-0000000014
    Processor: KSTREAM-PEEK-0000000016 (stores: [])
      --> KSTREAM-FILTER-0000000019
      <-- KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-FILTER-0000000019 (stores: [])
      --> KSTREAM-SINK-0000000018
      <-- KSTREAM-PEEK-0000000016
    Sink: KSTREAM-SINK-0000000018 (topic: KSTREAM-TOTABLE-0000000017-repartition)
      <-- KSTREAM-FILTER-0000000019


2025-12-16 22:28:22.532 [main] WARN  o.a.k.s.p.internals.StateDirectory - Using an OS temp directory in the state.dir property can cause failures with writing the checkpoint file due to the fact that this directory can be cleared by the OS. Resolved state.dir: [/tmp/kafka-streams]
2025-12-16 22:28:22.573 [main] INFO  c.b.s.topology.EVOpportunityTopology - Joined odds: Ravens | pinnacle @ 2.0 vs kalshi @ 2.1
2025-12-16 22:28:22.576 [main] INFO  c.b.s.topology.EVOpportunityTopology - Joined odds: Ravens | pinnacle @ 2.0 vs kalshi @ 2.25
]]></system-out>
  </testcase>
  <testcase name="testBasicJoin_Bovada" classname="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.039">
    <system-out><![CDATA[2025-12-16 22:28:22.583 [main] INFO  c.b.s.topology.EVOpportunityTopology - Building odds join topology...
2025-12-16 22:28:22.583 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: pinny-transformed with store: pinnacle-store
2025-12-16 22:28:22.583 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: kalshi-transformed with store: kalshi-store
2025-12-16 22:28:22.583 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: bovada-transformed with store: bovada-store
2025-12-16 22:28:22.584 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> kalshi
2025-12-16 22:28:22.584 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> bovada
2025-12-16 22:28:22.584 [main] INFO  c.b.s.topology.EVOpportunityTopology - Topology built successfully:
Topologies:
   Sub-topology: 0
    Source: KSTREAM-SOURCE-0000000000 (topics: [pinny-transformed])
      --> KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-KEY-SELECT-0000000001 (stores: [])
      --> KSTREAM-PEEK-0000000002
      <-- KSTREAM-SOURCE-0000000000
    Processor: KSTREAM-PEEK-0000000002 (stores: [])
      --> KSTREAM-FILTER-0000000005
      <-- KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-FILTER-0000000005 (stores: [])
      --> KSTREAM-SINK-0000000004
      <-- KSTREAM-PEEK-0000000002
    Sink: KSTREAM-SINK-0000000004 (topic: KSTREAM-TOTABLE-0000000003-repartition)
      <-- KSTREAM-FILTER-0000000005

  Sub-topology: 1
    Source: KSTREAM-SOURCE-0000000006 (topics: [KSTREAM-TOTABLE-0000000003-repartition])
      --> KSTREAM-TOTABLE-0000000003
    Processor: KSTREAM-TOTABLE-0000000003 (stores: [pinnacle-store])
      --> KTABLE-JOINTHIS-0000000023, KTABLE-JOINTHIS-0000000028
      <-- KSTREAM-SOURCE-0000000006
    Source: KSTREAM-SOURCE-0000000013 (topics: [KSTREAM-TOTABLE-0000000010-repartition])
      --> KSTREAM-TOTABLE-0000000010
    Source: KSTREAM-SOURCE-0000000020 (topics: [KSTREAM-TOTABLE-0000000017-repartition])
      --> KSTREAM-TOTABLE-0000000017
    Processor: KSTREAM-TOTABLE-0000000010 (stores: [kalshi-store])
      --> KTABLE-JOINOTHER-0000000024
      <-- KSTREAM-SOURCE-0000000013
    Processor: KSTREAM-TOTABLE-0000000017 (stores: [bovada-store])
      --> KTABLE-JOINOTHER-0000000029
      <-- KSTREAM-SOURCE-0000000020
    Processor: KTABLE-JOINOTHER-0000000024 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000010
    Processor: KTABLE-JOINOTHER-0000000029 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000017
    Processor: KTABLE-JOINTHIS-0000000023 (stores: [kalshi-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-JOINTHIS-0000000028 (stores: [bovada-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-MERGE-0000000022 (stores: [KTABLE-MERGE-STATE-STORE-0000000021])
      --> KTABLE-TOSTREAM-0000000025
      <-- KTABLE-JOINTHIS-0000000023, KTABLE-JOINOTHER-0000000024
    Processor: KTABLE-MERGE-0000000027 (stores: [KTABLE-MERGE-STATE-STORE-0000000026])
      --> KTABLE-TOSTREAM-0000000030
      <-- KTABLE-JOINTHIS-0000000028, KTABLE-JOINOTHER-0000000029
    Processor: KTABLE-TOSTREAM-0000000025 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000022
    Processor: KTABLE-TOSTREAM-0000000030 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000027
    Processor: KSTREAM-MERGE-0000000031 (stores: [])
      --> KSTREAM-FILTER-0000000032
      <-- KTABLE-TOSTREAM-0000000025, KTABLE-TOSTREAM-0000000030
    Processor: KSTREAM-FILTER-0000000032 (stores: [])
      --> KSTREAM-PEEK-0000000033
      <-- KSTREAM-MERGE-0000000031
    Processor: KSTREAM-PEEK-0000000033 (stores: [])
      --> KSTREAM-SINK-0000000034
      <-- KSTREAM-FILTER-0000000032
    Sink: KSTREAM-SINK-0000000034 (topic: joined-odds)
      <-- KSTREAM-PEEK-0000000033

  Sub-topology: 2
    Source: KSTREAM-SOURCE-0000000007 (topics: [kalshi-transformed])
      --> KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-KEY-SELECT-0000000008 (stores: [])
      --> KSTREAM-PEEK-0000000009
      <-- KSTREAM-SOURCE-0000000007
    Processor: KSTREAM-PEEK-0000000009 (stores: [])
      --> KSTREAM-FILTER-0000000012
      <-- KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-FILTER-0000000012 (stores: [])
      --> KSTREAM-SINK-0000000011
      <-- KSTREAM-PEEK-0000000009
    Sink: KSTREAM-SINK-0000000011 (topic: KSTREAM-TOTABLE-0000000010-repartition)
      <-- KSTREAM-FILTER-0000000012

  Sub-topology: 3
    Source: KSTREAM-SOURCE-0000000014 (topics: [bovada-transformed])
      --> KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-KEY-SELECT-0000000015 (stores: [])
      --> KSTREAM-PEEK-0000000016
      <-- KSTREAM-SOURCE-0000000014
    Processor: KSTREAM-PEEK-0000000016 (stores: [])
      --> KSTREAM-FILTER-0000000019
      <-- KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-FILTER-0000000019 (stores: [])
      --> KSTREAM-SINK-0000000018
      <-- KSTREAM-PEEK-0000000016
    Sink: KSTREAM-SINK-0000000018 (topic: KSTREAM-TOTABLE-0000000017-repartition)
      <-- KSTREAM-FILTER-0000000019


2025-12-16 22:28:22.585 [main] WARN  o.a.k.s.p.internals.StateDirectory - Using an OS temp directory in the state.dir property can cause failures with writing the checkpoint file due to the fact that this directory can be cleared by the OS. Resolved state.dir: [/tmp/kafka-streams]
2025-12-16 22:28:22.617 [main] INFO  c.b.s.topology.EVOpportunityTopology - Joined odds: Cowboys -3.5 | pinnacle @ 1.91 vs bovada @ 2.05
]]></system-out>
  </testcase>
  <testcase name="testBasicJoin_Kalshi" classname="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.04">
    <system-out><![CDATA[2025-12-16 22:28:22.623 [main] INFO  c.b.s.topology.EVOpportunityTopology - Building odds join topology...
2025-12-16 22:28:22.623 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: pinny-transformed with store: pinnacle-store
2025-12-16 22:28:22.624 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: kalshi-transformed with store: kalshi-store
2025-12-16 22:28:22.624 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: bovada-transformed with store: bovada-store
2025-12-16 22:28:22.624 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> kalshi
2025-12-16 22:28:22.624 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> bovada
2025-12-16 22:28:22.625 [main] INFO  c.b.s.topology.EVOpportunityTopology - Topology built successfully:
Topologies:
   Sub-topology: 0
    Source: KSTREAM-SOURCE-0000000000 (topics: [pinny-transformed])
      --> KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-KEY-SELECT-0000000001 (stores: [])
      --> KSTREAM-PEEK-0000000002
      <-- KSTREAM-SOURCE-0000000000
    Processor: KSTREAM-PEEK-0000000002 (stores: [])
      --> KSTREAM-FILTER-0000000005
      <-- KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-FILTER-0000000005 (stores: [])
      --> KSTREAM-SINK-0000000004
      <-- KSTREAM-PEEK-0000000002
    Sink: KSTREAM-SINK-0000000004 (topic: KSTREAM-TOTABLE-0000000003-repartition)
      <-- KSTREAM-FILTER-0000000005

  Sub-topology: 1
    Source: KSTREAM-SOURCE-0000000006 (topics: [KSTREAM-TOTABLE-0000000003-repartition])
      --> KSTREAM-TOTABLE-0000000003
    Processor: KSTREAM-TOTABLE-0000000003 (stores: [pinnacle-store])
      --> KTABLE-JOINTHIS-0000000023, KTABLE-JOINTHIS-0000000028
      <-- KSTREAM-SOURCE-0000000006
    Source: KSTREAM-SOURCE-0000000013 (topics: [KSTREAM-TOTABLE-0000000010-repartition])
      --> KSTREAM-TOTABLE-0000000010
    Source: KSTREAM-SOURCE-0000000020 (topics: [KSTREAM-TOTABLE-0000000017-repartition])
      --> KSTREAM-TOTABLE-0000000017
    Processor: KSTREAM-TOTABLE-0000000010 (stores: [kalshi-store])
      --> KTABLE-JOINOTHER-0000000024
      <-- KSTREAM-SOURCE-0000000013
    Processor: KSTREAM-TOTABLE-0000000017 (stores: [bovada-store])
      --> KTABLE-JOINOTHER-0000000029
      <-- KSTREAM-SOURCE-0000000020
    Processor: KTABLE-JOINOTHER-0000000024 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000010
    Processor: KTABLE-JOINOTHER-0000000029 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000017
    Processor: KTABLE-JOINTHIS-0000000023 (stores: [kalshi-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-JOINTHIS-0000000028 (stores: [bovada-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-MERGE-0000000022 (stores: [KTABLE-MERGE-STATE-STORE-0000000021])
      --> KTABLE-TOSTREAM-0000000025
      <-- KTABLE-JOINTHIS-0000000023, KTABLE-JOINOTHER-0000000024
    Processor: KTABLE-MERGE-0000000027 (stores: [KTABLE-MERGE-STATE-STORE-0000000026])
      --> KTABLE-TOSTREAM-0000000030
      <-- KTABLE-JOINTHIS-0000000028, KTABLE-JOINOTHER-0000000029
    Processor: KTABLE-TOSTREAM-0000000025 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000022
    Processor: KTABLE-TOSTREAM-0000000030 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000027
    Processor: KSTREAM-MERGE-0000000031 (stores: [])
      --> KSTREAM-FILTER-0000000032
      <-- KTABLE-TOSTREAM-0000000025, KTABLE-TOSTREAM-0000000030
    Processor: KSTREAM-FILTER-0000000032 (stores: [])
      --> KSTREAM-PEEK-0000000033
      <-- KSTREAM-MERGE-0000000031
    Processor: KSTREAM-PEEK-0000000033 (stores: [])
      --> KSTREAM-SINK-0000000034
      <-- KSTREAM-FILTER-0000000032
    Sink: KSTREAM-SINK-0000000034 (topic: joined-odds)
      <-- KSTREAM-PEEK-0000000033

  Sub-topology: 2
    Source: KSTREAM-SOURCE-0000000007 (topics: [kalshi-transformed])
      --> KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-KEY-SELECT-0000000008 (stores: [])
      --> KSTREAM-PEEK-0000000009
      <-- KSTREAM-SOURCE-0000000007
    Processor: KSTREAM-PEEK-0000000009 (stores: [])
      --> KSTREAM-FILTER-0000000012
      <-- KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-FILTER-0000000012 (stores: [])
      --> KSTREAM-SINK-0000000011
      <-- KSTREAM-PEEK-0000000009
    Sink: KSTREAM-SINK-0000000011 (topic: KSTREAM-TOTABLE-0000000010-repartition)
      <-- KSTREAM-FILTER-0000000012

  Sub-topology: 3
    Source: KSTREAM-SOURCE-0000000014 (topics: [bovada-transformed])
      --> KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-KEY-SELECT-0000000015 (stores: [])
      --> KSTREAM-PEEK-0000000016
      <-- KSTREAM-SOURCE-0000000014
    Processor: KSTREAM-PEEK-0000000016 (stores: [])
      --> KSTREAM-FILTER-0000000019
      <-- KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-FILTER-0000000019 (stores: [])
      --> KSTREAM-SINK-0000000018
      <-- KSTREAM-PEEK-0000000016
    Sink: KSTREAM-SINK-0000000018 (topic: KSTREAM-TOTABLE-0000000017-repartition)
      <-- KSTREAM-FILTER-0000000019


2025-12-16 22:28:22.626 [main] WARN  o.a.k.s.p.internals.StateDirectory - Using an OS temp directory in the state.dir property can cause failures with writing the checkpoint file due to the fact that this directory can be cleared by the OS. Resolved state.dir: [/tmp/kafka-streams]
2025-12-16 22:28:22.657 [main] INFO  c.b.s.topology.EVOpportunityTopology - Joined odds: Eagles | pinnacle @ 2.0 vs kalshi @ 2.1
]]></system-out>
  </testcase>
  <testcase name="testJoinKeyMatching_DifferentSelections" classname="com.blitzlines.streams.topology.EVOpportunityTopologyTest" time="0.042">
    <system-out><![CDATA[2025-12-16 22:28:22.663 [main] INFO  c.b.s.topology.EVOpportunityTopology - Building odds join topology...
2025-12-16 22:28:22.664 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: pinny-transformed with store: pinnacle-store
2025-12-16 22:28:22.664 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: kalshi-transformed with store: kalshi-store
2025-12-16 22:28:22.664 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable for topic: bovada-transformed with store: bovada-store
2025-12-16 22:28:22.664 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> kalshi
2025-12-16 22:28:22.664 [main] INFO  c.b.s.topology.EVOpportunityTopology - Creating KTable join: pinnacle <-> bovada
2025-12-16 22:28:22.665 [main] INFO  c.b.s.topology.EVOpportunityTopology - Topology built successfully:
Topologies:
   Sub-topology: 0
    Source: KSTREAM-SOURCE-0000000000 (topics: [pinny-transformed])
      --> KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-KEY-SELECT-0000000001 (stores: [])
      --> KSTREAM-PEEK-0000000002
      <-- KSTREAM-SOURCE-0000000000
    Processor: KSTREAM-PEEK-0000000002 (stores: [])
      --> KSTREAM-FILTER-0000000005
      <-- KSTREAM-KEY-SELECT-0000000001
    Processor: KSTREAM-FILTER-0000000005 (stores: [])
      --> KSTREAM-SINK-0000000004
      <-- KSTREAM-PEEK-0000000002
    Sink: KSTREAM-SINK-0000000004 (topic: KSTREAM-TOTABLE-0000000003-repartition)
      <-- KSTREAM-FILTER-0000000005

  Sub-topology: 1
    Source: KSTREAM-SOURCE-0000000006 (topics: [KSTREAM-TOTABLE-0000000003-repartition])
      --> KSTREAM-TOTABLE-0000000003
    Processor: KSTREAM-TOTABLE-0000000003 (stores: [pinnacle-store])
      --> KTABLE-JOINTHIS-0000000023, KTABLE-JOINTHIS-0000000028
      <-- KSTREAM-SOURCE-0000000006
    Source: KSTREAM-SOURCE-0000000013 (topics: [KSTREAM-TOTABLE-0000000010-repartition])
      --> KSTREAM-TOTABLE-0000000010
    Source: KSTREAM-SOURCE-0000000020 (topics: [KSTREAM-TOTABLE-0000000017-repartition])
      --> KSTREAM-TOTABLE-0000000017
    Processor: KSTREAM-TOTABLE-0000000010 (stores: [kalshi-store])
      --> KTABLE-JOINOTHER-0000000024
      <-- KSTREAM-SOURCE-0000000013
    Processor: KSTREAM-TOTABLE-0000000017 (stores: [bovada-store])
      --> KTABLE-JOINOTHER-0000000029
      <-- KSTREAM-SOURCE-0000000020
    Processor: KTABLE-JOINOTHER-0000000024 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000010
    Processor: KTABLE-JOINOTHER-0000000029 (stores: [pinnacle-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000017
    Processor: KTABLE-JOINTHIS-0000000023 (stores: [kalshi-store])
      --> KTABLE-MERGE-0000000022
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-JOINTHIS-0000000028 (stores: [bovada-store])
      --> KTABLE-MERGE-0000000027
      <-- KSTREAM-TOTABLE-0000000003
    Processor: KTABLE-MERGE-0000000022 (stores: [KTABLE-MERGE-STATE-STORE-0000000021])
      --> KTABLE-TOSTREAM-0000000025
      <-- KTABLE-JOINTHIS-0000000023, KTABLE-JOINOTHER-0000000024
    Processor: KTABLE-MERGE-0000000027 (stores: [KTABLE-MERGE-STATE-STORE-0000000026])
      --> KTABLE-TOSTREAM-0000000030
      <-- KTABLE-JOINTHIS-0000000028, KTABLE-JOINOTHER-0000000029
    Processor: KTABLE-TOSTREAM-0000000025 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000022
    Processor: KTABLE-TOSTREAM-0000000030 (stores: [])
      --> KSTREAM-MERGE-0000000031
      <-- KTABLE-MERGE-0000000027
    Processor: KSTREAM-MERGE-0000000031 (stores: [])
      --> KSTREAM-FILTER-0000000032
      <-- KTABLE-TOSTREAM-0000000025, KTABLE-TOSTREAM-0000000030
    Processor: KSTREAM-FILTER-0000000032 (stores: [])
      --> KSTREAM-PEEK-0000000033
      <-- KSTREAM-MERGE-0000000031
    Processor: KSTREAM-PEEK-0000000033 (stores: [])
      --> KSTREAM-SINK-0000000034
      <-- KSTREAM-FILTER-0000000032
    Sink: KSTREAM-SINK-0000000034 (topic: joined-odds)
      <-- KSTREAM-PEEK-0000000033

  Sub-topology: 2
    Source: KSTREAM-SOURCE-0000000007 (topics: [kalshi-transformed])
      --> KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-KEY-SELECT-0000000008 (stores: [])
      --> KSTREAM-PEEK-0000000009
      <-- KSTREAM-SOURCE-0000000007
    Processor: KSTREAM-PEEK-0000000009 (stores: [])
      --> KSTREAM-FILTER-0000000012
      <-- KSTREAM-KEY-SELECT-0000000008
    Processor: KSTREAM-FILTER-0000000012 (stores: [])
      --> KSTREAM-SINK-0000000011
      <-- KSTREAM-PEEK-0000000009
    Sink: KSTREAM-SINK-0000000011 (topic: KSTREAM-TOTABLE-0000000010-repartition)
      <-- KSTREAM-FILTER-0000000012

  Sub-topology: 3
    Source: KSTREAM-SOURCE-0000000014 (topics: [bovada-transformed])
      --> KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-KEY-SELECT-0000000015 (stores: [])
      --> KSTREAM-PEEK-0000000016
      <-- KSTREAM-SOURCE-0000000014
    Processor: KSTREAM-PEEK-0000000016 (stores: [])
      --> KSTREAM-FILTER-0000000019
      <-- KSTREAM-KEY-SELECT-0000000015
    Processor: KSTREAM-FILTER-0000000019 (stores: [])
      --> KSTREAM-SINK-0000000018
      <-- KSTREAM-PEEK-0000000016
    Sink: KSTREAM-SINK-0000000018 (topic: KSTREAM-TOTABLE-0000000017-repartition)
      <-- KSTREAM-FILTER-0000000019


2025-12-16 22:28:22.665 [main] WARN  o.a.k.s.p.internals.StateDirectory - Using an OS temp directory in the state.dir property can cause failures with writing the checkpoint file due to the fact that this directory can be cleared by the OS. Resolved state.dir: [/tmp/kafka-streams]
]]></system-out>
  </testcase>
</testsuite>